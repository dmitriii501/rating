{% extends "base.html" %}
{% block title %}Админ — Начисления{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
	<h1 class="h5">Начисление баллов</h1>
	<a class="btn btn-outline-danger" href="{{ url_for('admin.logout') }}">Выйти</a>
	</div>
<div class="row g-3">
	<div class="col-lg-5">
		<div class="p-3 bg-white rounded border">
			<div class="fw-semibold mb-2">Добавить начисление</div>
			<form method="post">
				<div class="mb-2">
					<label class="form-label">Участник</label>
					<select class="form-select" name="user_id" required>
						{% for u in users %}
							<option value="{{ u.id }}">{{ u.name }}</option>
						{% endfor %}
					</select>
				</div>
				<div class="mb-2">
					<label class="form-label">Активность</label>
					<select class="form-select" name="activity_id" required>
						{% for a in activities %}
							<option value="{{ a.id }}">{{ a.name }}</option>
						{% endfor %}
					</select>
				</div>
				<div class="mb-3">
					<label class="form-label">Баллы (1–10)</label>
					<input class="form-control" type="number" name="points" min="1" max="10" value="1" required>
				</div>
				<button class="btn btn-dark" type="submit">Начислить</button>
			</form>
		</div>
	</div>
	<div class="col-lg-7">
		<div class="p-3 bg-white rounded border">
			<div class="fw-semibold mb-2">Последние начисления</div>
			<div class="table-responsive">
				<table class="table table-sm align-middle">
					<thead>
					<tr>
						<th>Дата</th>
						<th>Участник</th>
						<th>Активность</th>
						<th class="text-end">Баллы</th>
					</tr>
					</thead>
					<tbody>
					{% for s, user_name, activity_name in recent_scores %}
					<tr>
						<td>{{ s.date.strftime('%Y-%m-%d %H:%M') }}</td>
						<td>{{ user_name }}</td>
						<td>{{ activity_name }}</td>
						<td class="text-end fw-semibold">+{{ s.points }}</td>
					</tr>
					{% endfor %}
					</tbody>
				</table>
			</div>
			{% if not recent_scores %}
				<div class="text-muted">Пока нет начислений.</div>
			{% endif %}
		</div>
	</div>
</div>
{% endblock %}


