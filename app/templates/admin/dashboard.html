{% extends "base.html" %}
{% block title %}Админ — Панель{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
	<h1 class="h5">Панель администратора</h1>
	<a class="btn btn-outline-danger" href="{{ url_for('admin.logout') }}">Выйти</a>
</div>
<div class="row g-3">
	<div class="col-sm-6 col-lg-3">
		<div class="card h-100">
			<div class="card-body">
				<div class="small text-muted">Участников</div>
				<div class="fs-4 fw-bold">{{ user_count }}</div>
			</div>
		</div>
	</div>
	<div class="col-sm-6 col-lg-3">
		<div class="card h-100">
			<div class="card-body">
				<div class="small text-muted">Отделов</div>
				<div class="fs-4 fw-bold">{{ dept_count }}</div>
			</div>
		</div>
	</div>
	<div class="col-sm-6 col-lg-3">
		<div class="card h-100">
			<div class="card-body">
				<div class="small text-muted">Активностей</div>
				<div class="fs-4 fw-bold">{{ activity_count }}</div>
			</div>
		</div>
	</div>
	<div class="col-sm-6 col-lg-3">
		<div class="card h-100">
			<div class="card-body">
				<div class="small text-muted">Всего баллов</div>
				<div class="fs-4 fw-bold">{{ total_points }}</div>
			</div>
		</div>
	</div>
</div>
<div class="p-3 bg-white rounded border mt-3">
	<div class="d-flex justify-content-between">
		<div class="fw-semibold">Последние начисления</div>
		<div>
			<a class="btn btn-sm btn-outline-dark" href="{{ url_for('admin.users') }}">Участники</a>
			<a class="btn btn-sm btn-outline-dark" href="{{ url_for('admin.departments') }}">Отделы</a>
			<a class="btn btn-sm btn-outline-dark" href="{{ url_for('admin.activities') }}">Активности</a>
			<a class="btn btn-sm btn-dark" href="{{ url_for('admin.scores') }}">Начислить</a>
		</div>
	</div>
	<div class="table-responsive mt-2">
		<table class="table table-sm align-middle">
			<thead>
			<tr>
				<th>Дата</th>
				<th>Участник</th>
				<th>Активность</th>
				<th class="text-end">Баллы</th>
			</tr>
			</thead>
			<tbody>
			{% for s in recent_scores %}
			<tr>
				<td>{{ s.date.strftime('%Y-%m-%d %H:%M') }}</td>
				<td>{{ s.user.name }}</td>
				<td>{{ s.activity.name }}</td>
				<td class="text-end fw-semibold">+{{ s.points }}</td>
			</tr>
			{% endfor %}
			</tbody>
		</table>
		{% if not recent_scores %}
			<div class="text-muted">Пока нет начислений.</div>
		{% endif %}
	</div>
</div>
{% endblock %}


